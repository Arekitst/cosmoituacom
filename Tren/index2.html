<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Login</title>
	<link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
	<style type="text/css">
		body {
			display: flex;
			align-items: center;
			min-height: 100vh;
			justify-content: center;
			background: green;
		}
		
		.name, .pass, .file-input {
			border-radius: 10px;
			font-size: 20px;
			margin-bottom: 10px;
			padding: 10px;
		}

		.main {
			background: lightgray;
			border: 1px solid black;
			width: 400px;
			height: 550px;
			align-items: center;
			display: flex;
			flex-direction: column;
			justify-content: center;
			position: relative;
		}

		.btn {
			text-decoration: none;
			border: 1px solid black;
			border-radius: 20px;
			font-size: 30px;
			cursor: pointer;
			padding: 10px 20px;
			background-color: #3498db;
			color: white;
		}

		.loader {
			display: none;
			border: 5px solid #f3f3f3;
			border-radius: 50%;
			border-top: 5px solid #3498db;
			width: 50px;
			height: 50px;
			animation: spin 1s linear infinite;
			margin-top: 20px;
		}

		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}

		.success {
			display: none;
			color: green;
			font-size: 24px;
			margin-top: 20px;
		}

		.checkmark {
			display: none;
			width: 50px;
			height: 50px;
			border-radius: 50%;
			background-color: green;
			position: relative;
			margin-top: 20px;
		}

		.checkmark:after {
			content: '✔';
			position: absolute;
			font-size: 30px;
			color: white;
			top: 5px;
			left: 10px;
		}

		.result {
			display: none;
			font-size: 24px;
			margin-top: 20px;
		}

		.avatar {
			display: none;
			width: 50px;
			height: 50px;
			background-color: blue;
			border-radius: 50%;
			margin-right: 10px;
			overflow: hidden;
		}

		.avatar img {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}

		.user-info {
			display: none;
			display: flex;
			align-items: center;
			margin-top: 20px;
			font-size: 24px;
		}

		.logout-btn {
			display: none;
			margin-top: 20px;
			padding: 10px 20px;
			background-color: red;
			color: white;
			border: none;
			cursor: pointer;
			border-radius: 10px;
			font-size: 20px;
		}
	</style>
</head>
<body>
	<div class="main">
		<h1>Login</h1>
		<div class="form">
			<div>
				<input class="name" type="text" name="name" placeholder="name">
				<box-icon name='user'></box-icon>
			</div>
			<div>
				<input class="pass" type="password" name="pass" placeholder="Password">
				<box-icon name='lock-alt'></box-icon>
			</div>
			<div>
				<input class="file-input" type="file" name="avatar" accept="image/*">
			</div>
			<button class="btn">Login</button>
		</div>
		<div class="loader"></div>
		<div class="checkmark"></div>
		<div class="result"></div>
		<div class="user-info">
			<div class="avatar"></div>
			<div class="user-name"></div>
		</div>
		<button class="logout-btn">Выйти</button>
	</div>

	<script type="text/javascript">
		// Находим элементы
		const loginButton = document.querySelector('.btn');
		const nameInput = document.querySelector('.name');
		const passInput = document.querySelector('.pass');
		const fileInput = document.querySelector('.file-input');
		const loader = document.querySelector('.loader');
		const checkmark = document.querySelector('.checkmark');
		const result = document.querySelector('.result');
		const userInfo = document.querySelector('.user-info');
		const avatar = document.querySelector('.avatar');
		const userName = document.querySelector('.user-name');
		const form = document.querySelector('.form');
		const logoutButton = document.querySelector('.logout-btn');

		// Проверка, есть ли сохранённые данные в LocalStorage
		document.addEventListener('DOMContentLoaded', function() {
			const savedName = localStorage.getItem('username');
			const savedAvatar = localStorage.getItem('avatar');

			if (savedName) {
				// Скрываем форму, если данные уже есть
				form.style.display = 'none';
				userName.innerHTML = savedName;
				userInfo.style.display = 'flex';
				avatar.style.display = 'block';
				logoutButton.style.display = 'block'; // Показываем кнопку выхода

				if (savedAvatar) {
					const img = document.createElement('img');
					img.src = savedAvatar;
					avatar.innerHTML = '';
					avatar.appendChild(img);
				} else {
					avatar.style.backgroundColor = 'blue'; // Стандартный аватар
				}
			}
		});

		// Добавляем обработчик клика на кнопку
		loginButton.addEventListener('click', function() {
			// Получаем введённые данные
			const nameValue = nameInput.value;
			const passValue = passInput.value;
			const avatarFile = fileInput.files[0];

			// Скрываем элементы формы
			nameInput.style.display = 'none';
			passInput.style.display = 'none';
			loginButton.style.display = 'none';
			fileInput.style.display = 'none';

			// Показываем анимацию загрузки
			loader.style.display = 'block';

			// Через 3 секунды скрываем загрузку, показываем галочку и результат
			setTimeout(function() {
				loader.style.display = 'none';
				checkmark.style.display = 'block';
				result.innerHTML = `Username: ${nameValue}<br>Password: ${passValue}`;
				result.style.display = 'block';

				// Сохраняем данные в LocalStorage
				localStorage.setItem('username', nameValue);

				// Если аватар загружен, читаем файл и сохраняем его в LocalStorage
				if (avatarFile) {
					const reader = new FileReader();
					reader.onload = function(e) {
						localStorage.setItem('avatar', e.target.result); // Сохраняем аватар как base64
					};
					reader.readAsDataURL(avatarFile);
				}

				// Через 5 секунд скрываем результат и показываем аватар с именем пользователя
				setTimeout(function() {
					checkmark.style.display = 'none';
					result.style.display = 'none';
					userInfo.style.display = 'flex';
					userName.innerHTML = nameValue;

					// Проверяем, был ли загружен файл для аватара
					if (avatarFile) {
						const reader = new FileReader();
						reader.onload = function(e) {
							const img = document.createElement('img');
							img.src = e.target.result;
							avatar.innerHTML = ''; // Очистим старый контент аватара
							avatar.appendChild(img);
							avatar.style.display = 'block';
						};
						reader.readAsDataURL(avatarFile); // Читаем файл как URL
					} else {
						// Если аватар не загружен, показываем стандартный аватар
						avatar.style.backgroundColor = 'blue';
						avatar.style.display = 'block';
					}

					logoutButton.style.display = 'block'; // Показываем кнопку выхода
				}, 5000);
			}, 3000);
		});

		// Добавляем обработчик клика на кнопку выхода
		logoutButton.addEventListener('click', function() {
			// Очищаем данные из LocalStorage
			localStorage.removeItem('username');
			localStorage.removeItem('avatar');

			// Перезагружаем страницу для возврата к форме входа
			location.reload();
		});
	</script>
</body>
</html>
